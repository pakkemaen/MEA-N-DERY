<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEA(N)DERY - AI Mead Recipe Creator</title>
    
    <meta name="theme-color" content="#a89a87"/>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192x192.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">    

    <!-- Service Worker Registration -->

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js').then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>

<body class="bg-app-primary text-app-primary">

    <div id="login-view" class="fixed inset-0 bg-app-primary flex items-center justify-center z-50">
        <div class="text-center p-8 max-w-md mx-auto">
            <h1 class="text-6xl font-header text-app-header">MEA<span class="text-app-brand">(N)</span>DERY</h1>
            <p class="text-app-secondary mt-2 mb-8">Brewbuddy</p>
            <div class="card p-8 rounded-lg">
                <h2 class="text-2xl font-bold mb-4">Welcome</h2>
                <p class="text-app-secondary mb-6">Please sign in to access your brewing data.</p>
                <button id="google-login-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 btn flex items-center justify-center">
                    Sign in with Google
                </button>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header class="text-center mb-4 no-print">
            <h1 class="text-5xl font-header text-app-header">MEA<span class="text-app-brand">(N)</span>DERY</h1>
            <p class="text-app-secondary mt-2">Brewbuddy</p>
        </header>

        <!-- Main Content Area -->
        <div id="dashboard-main-view">
            <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 80vh;">
                
                <div id="current-brew-card" class="card p-6 rounded-lg mb-6 hidden">
                    <!-- Content injected by JS -->
                </div>

               <div id="next-action-widget" class="card p-6 rounded-lg mb-6 hidden bg-app-tertiary border-app">
                    <h3 class="text-xl font-header font-bold mb-3 text-app-header">What's next?</h3>
                    <ul id="next-action-list" class="list-disc pl-5 space-y-2 text-app-secondary">
                        </ul>
               </div>

               <div class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <button data-view="brewing" class="main-nav-btn card p-6 rounded-lg text-center hover:shadow-lg transition-shadow btn flex flex-col items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 mb-4 text-app-brand">
                            <path d="M10 2v7.31"></path><path d="M14 9.31V2"></path><path d="M8.5 2h7"></path><path d="M14 9.31C16.57 10.92 18 14.11 18 17.69V20a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-2.31C6 14.11 7.43 10.92 10 9.31Z"></path>
                        </svg>
                        <h3 class="text-xl font-header font-bold">Brewing</h3>
                        <p class="text-app-secondary/80 text-sm">Creator, Brew Day, History</p>
                    </button>
                    <button data-view="management" class="main-nav-btn card p-6 rounded-lg text-center hover:shadow-lg transition-shadow btn flex flex-col items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 mb-4 text-app-brand">
                            <rect width="20" height="5" x="2" y="3" rx="1"></rect><path d="M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8"></path><path d="M10 12h4"></path>
                        </svg>
                        <h3 class="text-xl font-header font-bold">Management</h3>
                        <p class="text-app-secondary/80 text-sm">Inventory, Planning, Financials</p>
                    </button>
                    <button data-view="tools" class="main-nav-btn card p-6 rounded-lg text-center hover:shadow-lg transition-shadow btn flex flex-col items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 mb-4 text-app-brand">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                        </svg>
                        <h3 class="text-xl font-header font-bold">Tools</h3>
                        <p class="text-app-secondary/80 text-sm">Calculators, Water, Social</p>
                    </button>
                    <button data-view="settings" class="main-nav-btn card p-6 rounded-lg text-center hover:shadow-lg transition-shadow btn flex flex-col items-center justify-center">
                       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 mb-4 text-app-brand">
                            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2.4l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2.4l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <h3 class="text-xl font-header font-bold">Settings</h3>
                        <p class="text-app-secondary/80 text-sm">Configure your app</p>
                    </button>
                </div>

                <div id="low-stock-card" class="card p-6 rounded-lg mb-6 hidden">
                     <h3 class="text-xl font-header font-bold mb-2 text-red-500">Low Stock Alerts</h3>
                     <ul id="low-stock-list" class="list-disc pl-5 text-app-secondary">
                        <!-- Content injected by JS -->
                     </ul>
                </div>

            </div>
        </div>

        <div id="brewing-main-view" class="hidden">
    <button class="back-to-dashboard-btn mb-4 text-app-brand hover:underline no-print">&larr; Back to Dashboard</button>
    <div class="bg-app-secondary p-4 rounded-b-lg shadow-inner">
        <nav class="flex space-x-2 overflow-x-auto whitespace-nowrap">
            <button id="creator-sub-tab" class="sub-tab active px-4 py-2 rounded-md text-sm font-semibold">Creator</button>
            <button id="shopping-list-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Shopping List</button>
            <button id="brew-day-1-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Brew Day 1</button>
            <button id="brew-day-2-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Brew Day 2</button>
            <button id="history-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">History</button>
        </nav>
    </div>
            <div id="creator-view">
                <div class="flex flex-col lg:flex-row gap-8 mt-4">
                    <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg control-panel overflow-y-auto" style="max-height: 70vh;">
                        <h2 class="text-2xl font-header font-bold mb-6 border-b pb-4 border-app">Craft Your Mead</h2>
                        
                        <div class="mb-6">
                            <label for="customDescription" class="block text-sm font-bold mb-2">Describe Your Dream Mead</label>
                            <textarea id="customDescription" rows="4" placeholder="Be descriptive! e.g., 'A dry, sparkling mead with lavender and lemon, around 8% ABV, perfect for summer.'" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary"></textarea>
                            <p id="description-priority-warning" class="hidden text-xs text-center text-amber-600 dark:text-amber-400 mt-2">U gebruikt de vrije beschrijving. De onderstaande opties worden genegeerd.</p>
                            <p class="text-xs text-center text-app-secondary/80 mt-2">Or, use the options below for a more structured recipe.</p>
                        </div>

                        <div id="structured-options-container" class="space-y-6 pt-6 border-t border-app">
                            <div>
                                <label for="batchSize" class="block text-sm font-bold mb-2">Batch Size (Liters)</label>
                                <input type="number" id="batchSize" placeholder="5" min="1" max="100" step="0.5" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                            </div>
                            <div>
                                <label for="equipmentProfileSelect" class="block text-sm font-bold mb-2">Equipment Profile</label>
                                <select id="equipmentProfileSelect" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                    <option value="">None (Use default values)</option>
                                    </select>
                            </div>
                            <div>
                                <label for="abv" class="block text-sm font-bold mb-2">Target ABV (%)</label>
                                <input type="number" id="abv" placeholder="12" min="5" max="18" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                            </div>
                            <div>
                                <label for="sweetness" class="block text-sm font-bold mb-2">Final Sweetness</label>
                                <select id="sweetness" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                    <option value="" disabled selected>-- Select a Sweetness --</option>
                                    <option value="dry">Dry (FG ~1.000)</option>
                                    <option value="semi-sweet">Semi-Sweet (FG ~1.015)</option>
                                    <option value="sweet">Sweet (FG ~1.030)</option>
                                </select>
                            </div> 

                            <div>
                                <label for="style" class="block text-sm font-bold mb-2">Base Style</label>
                                <select id="style" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                   <option value="" disabled selected>-- Select a Style --</option>
                                   <optgroup label="Mead Styles">
                                       <option value="Traditional">Traditional Mead (Honey Only)</option>
                                       <option value="Melomel">Melomel (Fruit Mead)</option>
                                       <option value="Metheglin">Metheglin (Spice Mead)</option>
                                       <option value="Bochet">Bochet (Caramelized Honey)</option>
                                       <option value="Cyser">Cyser (Apple Mead)</option>
                                       <option value="Pyment">Pyment (Grape Mead)</option>
                                       <option value="Braggot">Braggot (Mead/Beer Hybrid)</option>
                                       <option value="Hydromel">Hydromel (Session Mead, <10% ABV)</option>
                                       <option value="Sack Mead">Sack Mead (Dessert Mead, >14% ABV)</option>
                                       <option value="Capsicumel">Capsicumel (Chili Pepper Mead)</option>
                                       <option value="Rhodomel">Rhodomel (Rose Mead)</option>
                                       <option value="Acerglyn">Acerglyn (Maple Mead)</option>
                                    </optgroup>
                                    <optgroup label="Alternative & Hybrid Styles">
                                       <option value="Bochetomel">Bochetomel (Caramelized Fruit Mead)</option>
                                       <option value="Viking's Blood">Viking's Blood (Cherry Melomel)</option>
                                       <option value="Black Mead">Black Mead (Blackcurrant Melomel)</option>
                                       <option value="Morat">Morat (Mulberry Mead)</option>
                                       <option value="Tej">Tej (Ethiopian Honey Wine)</option>
                                       <option value="Great Mead">Great Mead (Long-Aging Potential)</option>
                                       <option value="Short Mead">Short Mead (Quick Fermentation)</option>
                                       <option value="Sparkling Mead">Sparkling Mead</option>
                                    </optgroup>
                                </select>
                            </div>

                            <div>
                                <label for="honeyVariety" class="block text-sm font-bold mb-2">Honey Variety</label>
                                <select id="honeyVariety" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                    <option value="" disabled selected>-- Select a Honey --</option>
                                    <optgroup label="Floral & Light">
                                        <option value="Acacia">Acacia Honey</option>
                                        <option value="Linden">Linden Honey</option>
                                        <option value="Clover">Clover Honey</option>
                                        <option value="Rapeseed">Rapeseed Honey</option>
                                        <option value="Orange Blossom">Orange Blossom Honey</option>
                                        <option value="Wildflower">Wildflower Honey (Default)</option>
                                    </optgroup>
                                    <optgroup label="Fruity & Complex">
                                        <option value="Heather">Heather Honey</option>
                                        <option value="Himalayan Balsam">Himalayan Balsam Honey</option>
                                        <option value="Sunflower">Sunflower Honey</option>
                                    </optgroup>
                                    <optgroup label="Rich, Spicy & Dark">
                                        <option value="Chestnut">Chestnut Honey</option>
                                        <option value="Buckwheat">Buckwheat Honey</option>
                                        <option value="Forest/Honeydew">Forest/Honeydew Honey</option>
                                        <option value="Pine/Fir">Pine/Fir Honey</option>
                                    </optgroup>
                                    <optgroup label="Exotic & Special">
                                        <option value="Thyme">Thyme Honey</option>
                                        <option value="Lavender">Lavender Honey</option>
                                        <option value="Eucalyptus">Eucalyptus Honey</option>
                                    </optgroup>
                                    <option value="other">Other...</option>
                                </select>
                                <input type="text" id="honeyVarietyOther" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary mt-2 hidden" placeholder="Specify other honey">
                            </div>

                            <div id="fruit-section" class="hidden space-y-2">
                                <label class="block text-sm font-bold">Choose Fruits (for Melomel)</label>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_apples" class="mr-2"><label for="fruit_apples">Apples</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_apricots" class="mr-2"><label for="fruit_apricots">Apricots</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_blackberries" class="mr-2"><label for="fruit_blackberries">Blackberries</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_blackcurrants" class="mr-2"><label for="fruit_blackcurrants">Blackcurrants</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_blueberries" class="mr-2"><label for="fruit_blueberries">Blueberries</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_cherries" class="mr-2"><label for="fruit_cherries">Cherries</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_gooseberries" class="mr-2"><label for="fruit_gooseberries">Gooseberries</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_peaches" class="mr-2"><label for="fruit_peaches">Peaches</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_pears" class="mr-2"><label for="fruit_pears">Pears</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_plums" class="mr-2"><label for="fruit_plums">Plums</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_raspberries" class="mr-2"><label for="fruit_raspberries">Raspberries</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="fruit_redcurrants" class="mr-2"><label for="fruit_redcurrants">Redcurrants</label></div>
                                </div>

                                <div class="pt-2">
                                    <label for="fruitOther" class="block text-xs font-bold text-app-secondary">Other Fruits (comma-separated)</label>
                                    <input type="text" id="fruitOther" placeholder="e.g., Mango, Passion Fruit" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div> 
                            </div>

                             <div id="spice-section" class="hidden space-y-2">
                                <label class="block text-sm font-bold">Choose Spices (for Metheglin)</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_cinnamon" class="mr-2"><label for="spice_cinnamon">Cinnamon</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_cloves" class="mr-2"><label for="spice_cloves">Cloves</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_coriander" class="mr-2"><label for="spice_coriander">Coriander</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_nutmeg" class="mr-2"><label for="spice_nutmeg">Nutmeg</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_orange" class="mr-2"><label for="spice_orange">Orange Peel</label></div>
                                    <div class="p-2 rounded hover:bg-app-primary"><input type="checkbox" id="spice_vanilla" class="mr-2"><label for="spice_vanilla">Vanilla</label></div>
                                </div>
                                <div class="pt-2">
                                    <label for="spiceOther" class="block text-xs font-bold text-app-secondary">Other Spices (comma-separated)</label>
                                    <input type="text" id="spiceOther" placeholder="e.g., Star Anise, Grains of Paradise" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div>
                            </div>
                            <div id="braggot-section" class="hidden">
                                <label for="braggotStyle" class="block text-sm font-bold mb-2">Braggot Base Style</label>
                                <select id="braggotStyle" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                    <option value="belgian_blond">Belgian Blond</option>
                                    <option value="dubbel">Belgian Dubbel</option>
                                    <option value="ipa">IPA</option>
                                    <option value="old_ale">Old Ale / Barleywine</option>
                                    <option value="saison">Saison</option>
                                    <option value="scotch_ale">Scotch Ale / Wee Heavy</option>
                                    <option value="stout">Stout</option>
                                </select>
                            </div>
                            <div class="space-y-4 pt-4 border-t border-app">
                                <div class="flex items-center">
                                    <input type="checkbox" id="addOak" class="h-4 w-4 rounded border-gray-300 text-app-brand focus:ring-app-brand">
                                    <label for="addOak" class="ml-3 block text-sm font-bold">Include Oak Aging?</label>
                                </div>
                                <div>
                                    <label for="specialIngredients" class="block text-sm font-bold mb-2">Special Ingredients (optional)</label>
                                    <input type="text" id="specialIngredients" placeholder="e.g., Rose petals, Lapsang tea..." class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-4 pt-4 border-t-2 border-app-brand mt-6">
                             <div class="flex items-center">
                                <input type="checkbox" id="useInventory" class="h-4 w-4 rounded border-gray-300 text-app-brand focus:ring-app-brand">
                                <label for="useInventory" class="ml-3 block text-sm font-bold text-app-brand">Create recipe from my inventory</label>
                                <span id="inventory-helper-text" class="hidden ml-3 text-xs text-amber-600 dark:text-amber-400">De app gebruikt uw inventaris als basis en de andere opties als richtlijn.</span>
                            </div>
                            
                            <div id="budget-section" class="hidden pl-7 space-y-2">
                                <div class="flex items-center">
                                    <input type="checkbox" id="useBudget" class="h-4 w-4 rounded border-gray-300 text-app-brand focus:ring-app-brand">
                                    <label for="useBudget" class="ml-3 block text-sm font-bold">Generate within budget?</label>
                                </div>
                                <div id="budget-input-container" class="hidden">
                                    <label for="maxBudget" class="block text-sm font-bold mb-1">Max Budget</label>
                                    <input type="number" id="maxBudget" placeholder="20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div>
                            </div>
                        </div>
                        <div class="mt-8">
                            <button id="generateBtn" class="w-full bg-app-action text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition-all duration-300 shadow-md btn">
                                Generate Recipe
                            </button>
                        </div>
                    </aside>
                    <main class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
                        <div id="recipe-output" class="prose max-w-none text-app-primary">
                        </div>
                    </main>
                </div>
            </div>

            <div id="brew-day-1-view" class="hidden mt-4">
        <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 80vh;">
            <div id="brew-day-content">
                <h2 class="text-3xl font-header font-bold mb-4 text-center">Brew Day 1 - Primary Fermentation</h2>
                <p class="text-center text-app-secondary/80">Generate a recipe, click "Start New Batch", and the relevant steps will appear here.</p>
            </div>
        </div>
    </div>

    <div id="brew-day-2-view" class="hidden mt-4">
        <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 80vh;">
            <h2 class="text-3xl font-header font-bold mb-4 text-center">Brew Day 2 - Secondary / Aging</h2>
            <p class="text-center text-app-secondary/80">This section will show your batches that are in the secondary fermentation or aging phase.</p>
        </div>
    </div>
            <div id="history-view" class="hidden mt-4">
                 <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
                    <div id="history-list-container">
                        <h2 class="text-3xl font-header font-bold mb-4 text-center">Brew History</h2>                        
                        <div class="mb-4">
                            <input type="text" id="history-search-input" placeholder="Search recipes by name..." class="w-full p-3 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                        </div>                        
                        <div id="history-list" class="space-y-4">
                            </div>
                    </div>
                    <div id="history-detail-container" class="hidden">
                        </div>
                 </div>
            </div>
            <div id="shopping-list-view" class="hidden mt-4">
                <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg ...">
                      <h2 class="text-3xl font-header font-bold mb-6 text-center">Shopping List</h2>
                      <div id="shopping-list-container" class="mb-8">
                         <div id="shopping-list-content" class="p-4 card rounded-lg">
                             <p class="text-app-secondary text-center">Click "Start New Batch" on a saved recipe to generate a shopping list here.</p>
                         </div>
                      </div>
                </div>
            </div>
        </div>

        <div id="management-main-view" class="hidden">
             <button class="back-to-dashboard-btn mb-4 text-app-brand hover:underline no-print">&larr; Back to Dashboard</button>
             <div class="bg-app-secondary p-4 rounded-b-lg shadow-inner">
                <nav class="flex space-x-2 overflow-x-auto whitespace-nowrap">
                    <button id="inventory-sub-tab" class="sub-tab active px-4 py-2 rounded-md text-sm font-semibold">Inventory</button>
                    <button id="equipment-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Equipment</button>
                    <button id="packaging-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Packaging</button>
                    <button id="cellar-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Cellar</button>
                    <button id="financials-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Financials</button>
                </nav>
            </div>
            <div id="inventory-view" class="mt-4">
                <div class="flex flex-col lg:flex-row gap-8">
                    <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg">
                        <div id="barcode-scanner-container" class="relative hidden mb-4">
                            <div id="barcode-reader" class="w-full rounded-lg"></div>
                            <button id="close-scanner-btn" class="absolute top-2 right-2 bg-red-600 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold btn">&times;</button>
                        </div>
                        <h2 class="text-2xl font-header font-bold mb-6 border-b pb-4 border-app">Add to Inventory</h2>
                        <button id="scan-barcode-btn" class="w-full mb-4 bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2"><path d="M3 7V5a2 2 0 0 1 2-2h2"></path><path d="M17 3h2a2 2 0 0 1 2 2v2"></path><path d="M21 17v2a2 2 0 0 1-2 2h-2"></path><path d="M7 21H5a2 2 0 0 1-2-2v-2"></path><path d="M7 12h10"></path></svg>
                            Scan Barcode
                        </button>
                        <p class="text-xs text-center text-app-secondary/80 mb-4">- OR -</p>
                        <form id="inventory-form" class="space-y-4">
                            <div>
                                <label for="itemName" class="block text-sm font-bold mb-2">Ingredient Name</label>
                                <input type="text" id="itemName" placeholder="e.g., Acacia Honey" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="itemQty" class="block text-sm font-bold mb-2">Quantity</label>
                                    <input type="number" id="itemQty" step="0.01" placeholder="e.g., 1.5" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                </div>
                                <div>
                                    <label for="itemUnit" class="block text-sm font-bold mb-2">Unit</label>
                                    <select id="itemUnit" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                        <option>kg</option><option>g</option><option>L</option><option>ml</option><option>packets</option><option>items</option>
                                    </select>
                                </div>
                            </div>
                             <div>
                                <label for="itemPrice" class="block text-sm font-bold mb-2">Price (€)</label>
                                <input type="number" id="itemPrice" step="0.01" placeholder="e.g., 12.50" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                            </div>
                            <div>
                                <label for="itemCategory" class="block text-sm font-bold mb-2">Category</label>
                                <select id="itemCategory" class="w-full p-2 ...">
                                       <option>Honey</option><option>Yeast</option><option>Nutrient</option><option>Malt Extract</option><option>Fruit</option><option>Spice</option><option>Adjunct</option><option>Chemical</option>                  <option>Water</option>
                                </select>
                            </div>
                            <div>
                                <label for="itemExpirationDate" class="block text-sm font-bold mb-2">Expiration Date (Optional)</label>
                                <input type="date" id="itemExpirationDate" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand text-app-primary">
                            </div>
                            <button type="submit" class="w-full bg-app-action text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition-all duration-300 shadow-md btn">Add Ingredient</button>
                        </form>
                    </aside>
                    <main class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg inventory-panel overflow-y-auto" style="max-height: 70vh;">
                        <h2 class="text-3xl font-header font-bold mb-4 text-center">Current Stock</h2>
                        <div id="inventory-list"></div>
                    </main>
                </div>
            </div>
            <div id="packaging-view" class="hidden mt-4">
                <div class="flex flex-col lg:flex-row gap-8">
        
                    <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-header font-bold mb-6 border-b pb-4 border-app">Add Packaging Stock</h2>
                        <form id="packaging-add-form" class="space-y-4">
                            <div>
                                <label for="packaging-item-select" class="block text-sm font-bold mb-2">Packaging Material</label>
                                <select id="packaging-item-select" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                    </select>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="packaging-item-qty" class="block text-sm font-bold mb-2">Quantity Added</label>
                                    <input type="number" id="packaging-item-qty" step="1" min="0" placeholder="e.g., 24" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                                </div>
                               <div>
                                   <label for="packaging-item-price" class="block text-sm font-bold mb-2">Total Price Paid (€)</label>
                                   <input type="number" id="packaging-item-price" step="0.01" min="0" placeholder="e.g., 18.50" required class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand focus:border-app-brand text-app-primary">
                               </div>
                            </div>
                            <button type="submit" class="w-full bg-app-action text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition-all duration-300 shadow-md btn">
                                Add to Stock
                            </button>
                        </form>
                    </aside>
        
                    <main id="packaging-stock-container" class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg inventory-panel lg:overflow-y-auto lg:max-h-[70vh]">
                       <h2 class="text-3xl font-header font-bold mb-4 text-center">Current Packaging Stock</h2>
                       <div id="packaging-list" class="space-y-2">
                           </div>
                    </main>
                </div>
            </div>             
            <div id="equipment-view" class="hidden mt-4">
                <div class="flex flex-col lg:flex-row gap-8">
                    <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-header font-bold mb-6 border-b pb-4 border-app">Add Equipment Profile</h2>
                        <form id="equipment-profile-form" class="space-y-4">
                            <div>
                                <label for="equipProfileName" class="block text-sm font-bold mb-2">Profile Name</label>
                                <input type="text" id="equipProfileName" placeholder="e.g., My 30L Fermenter" required class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary focus:ring-2 focus:ring-app-brand">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="equipProfileType" class="block text-sm font-bold mb-2">Equipment Type</label>
                                    <select id="equipProfileType" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand text-app-primary">
                                        <option value="Fermenter">Fermenter</option>
                                        <option value="Kettle">Kettle / Boil Pot</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="equipProfileQuantity" class="block text-sm font-bold mb-2">Aantal</label>
                                    <input type="number" id="equipProfileQuantity" value="1" min="1" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="equipCapacityLiters" class="block text-sm font-bold mb-2">Total Capacity (L)</label>
                                    <input type="number" id="equipCapacityLiters" step="0.1" placeholder="30" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand text-app-primary">
                                </div>
                                <div>
                                    <label for="trubLossLiters" class="block text-sm font-bold mb-2">Trub/Yeast Loss (L)</label>
                                    <input type="number" id="trubLossLiters" step="0.1" placeholder="0.75" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand text-app-primary">
                                </div>
                            </div>
                            <div id="boil-off-rate-container" class="hidden">
                                <label for="boilOffRateLitersPerHour" class="block text-sm font-bold mb-2">Boil-Off Rate (Liters/Hour)</label>
                                <input type="number" id="boilOffRateLitersPerHour" step="0.1" placeholder="2.5" class="w-full p-2 border rounded-md bg-app-tertiary border-app focus:ring-2 focus:ring-app-brand text-app-primary">
                            </div>
                            <button type="submit" class="w-full bg-app-action text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition-all duration-300 shadow-md btn">Add Profile</button>
                        </form>
                    </aside>
                    <main class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg inventory-panel overflow-y-auto" style="max-height: 70vh;">
                        <h2 class="text-3xl font-header font-bold mb-4 text-center">Saved Equipment Profiles</h2>
                        <div id="equipment-profiles-list">
                        </div>
                    </main>
                </div>
            </div>
            <div id="cellar-view" class="hidden mt-4">
                <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
                    <h2 class="text-3xl font-header font-bold mb-6 text-center">My Cellar</h2>
                    <div id="cellar-list" class="space-y-4">
                    </div>
                </div>
            </div>
            <div id="financials-view" class="hidden mt-4">
    <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
         <h2 class="text-3xl font-header font-bold mb-6 text-center">Financials</h2>
         <div id="cost-analysis-container">
            <h3 class="text-2xl font-header mb-4">Cost Analysis</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-4 rounded-lg text-center">
                    <h4 class="text-lg font-bold text-app-secondary">Total Inventory Value</h4>
                    <p id="total-spend" class="text-3xl font-bold text-app-brand">€0.00</p>
                </div>
                <div class="card p-4 rounded-lg text-center">
                    <h4 class="text-lg font-bold text-app-secondary">Total Cellar Value</h4>
                    <p id="total-cellar-value" class="text-3xl font-bold text-app-brand">€0.00</p>
                </div>
            </div>
            <div class="card p-4 rounded-lg mt-6">
                <h4 class="text-lg font-bold text-app-secondary text-center mb-4">Spend by Category</h4>
                <canvas id="cost-chart"></canvas>
            </div>
         </div>
    </div>
</div>
        </div>
        <div id="tools-main-view" class="hidden">
            <button class="back-to-dashboard-btn mb-4 text-app-brand hover:underline no-print">&larr; Back to Dashboard</button>
            <div class="bg-app-secondary p-4 rounded-b-lg shadow-inner">
                <nav class="flex space-x-2 overflow-x-auto whitespace-nowrap">
                    <button id="calculators-sub-tab" class="sub-tab active px-4 py-2 rounded-md text-sm font-semibold">Calculators</button>
                    <button id="labels-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Labels</button>
                    <button id="water-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Water</button>
                    <button id="troubleshoot-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Troubleshoot</button>
                    <button id="social-sub-tab" class="sub-tab px-4 py-2 rounded-md text-sm font-semibold">Social</button>
                </nav>
            </div>
            
            <div id="calculators-view" class="mt-4">
                <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg calculator-panel overflow-y-auto" style="max-height: 80vh;">
                    <h2 class="text-3xl font-header font-bold mb-6 text-center">Brewing Calculators</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        
                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">ABV Calculator</h3>
                            <div class="space-y-4">
                                <div><label for="og" class="block text-sm font-bold mb-1">Original Gravity (OG)</label><input type="number" id="og" step="0.001" placeholder="e.g., 1.110" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="fg" class="block text-sm font-bold mb-1">Final Gravity (FG)</label><input type="number" id="fg" step="0.001" placeholder="e.g., 1.015" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="calcAbvBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate ABV</button>
                                <div id="abvResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">Hydrometer Correction</h3>
                            <div class="space-y-4">
                                <div><label for="sgReading" class="block text-sm font-bold mb-1">Hydrometer Reading</label><input type="number" id="sgReading" step="0.001" placeholder="e.g., 1.052" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="tempReading" class="block text-sm font-bold mb-1">Liquid Temperature (°C)</label><input type="number" id="tempReading" placeholder="e.g., 25" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="calTemp" class="block text-sm font-bold mb-1">Hydrometer Calibration Temp (°C)</label><input type="number" id="calTemp" value="20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="correctSgBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Correct Gravity</button>
                                <div id="sgResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">Backsweetening Calculator</h3>
                            <div class="space-y-4">
                                <div><label for="bs_current_vol" class="block text-sm font-bold mb-1">Current Volume (L)</label><input type="number" id="bs_current_vol" placeholder="20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="bs_current_sg" class="block text-sm font-bold mb-1">Current SG</label><input type="number" id="bs_current_sg" step="0.001" placeholder="0.998" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="bs_target_sg" class="block text-sm font-bold mb-1">Target SG</label><input type="number" id="bs_target_sg" step="0.001" placeholder="1.015" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="calcBacksweetenBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate Honey</button>
                                <div id="backsweetenResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg md:col-span-2 lg:col-span-3">
                             <h3 class="text-xl font-header mb-4">TOSNA Nutrient Calculator</h3>
                             <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div><label for="tosna_og" class="block text-sm font-bold mb-1">Original Gravity (OG)</label><input type="number" id="tosna_og" step="0.001" placeholder="1.110" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="tosna_vol" class="block text-sm font-bold mb-1">Batch Volume (L)</label><input type="number" id="tosna_vol" placeholder="20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="tosna_yeast" class="block text-sm font-bold mb-1">Yeast Nutrient Need</label><select id="tosna_yeast" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"><option value="low">Low</option><option value="medium" selected>Medium</option><option value="high">High</option></select></div>
                             </div>
                             <button id="calcTosnaBtn" class="w-full mt-4 bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate Schedule</button>
                             <div id="tosnaResult" class="prose max-w-none text-app-primary mt-4"></div>
                        </div>
                        
                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">Dilution Calculator</h3>
                            <div class="space-y-4">
                                <div><label for="dil_start_vol" class="block text-sm font-bold mb-1">Starting Volume (L)</label><input type="number" id="dil_start_vol" placeholder="18" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="dil_start_sg" class="block text-sm font-bold mb-1">Starting SG</label><input type="number" id="dil_start_sg" step="0.001" placeholder="1.120" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="dil_target_sg" class="block text-sm font-bold mb-1">Target SG</label><input type="number" id="dil_target_sg" step="0.001" placeholder="1.100" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="calcDilutionBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate Dilution</button>
                                <div id="dilutionResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">Priming Sugar Calculator</h3>
                            <div class="space-y-4">
                                <div><label for="carbVol" class="block text-sm font-bold mb-1">Target CO2 Volume</label><input type="number" id="carbVol" step="0.1" placeholder="e.g., 2.5" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="carbTemp" class="block text-sm font-bold mb-1">Mead Temperature (°C)</label><input type="number" id="carbTemp" placeholder="e.g., 20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="carbBatchSize" class="block text-sm font-bold mb-1">Batch Size (L)</label><input type="number" id="carbBatchSize" step="0.1" placeholder="e.g., 19" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="calcSugarBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate Sugar</button>
                                <div id="sugarResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg">
                            <h3 class="text-xl font-header mb-4">Blending Calculator</h3>
                            <div class="space-y-4">
                                <div><label for="vol1" class="block text-sm font-bold mb-1">Volume 1 (L)</label><input type="number" id="vol1" step="0.1" placeholder="10" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="sg1" class="block text-sm font-bold mb-1">SG 1</label><input type="number" id="sg1" step="0.001" placeholder="1.020" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="vol2" class="block text-sm font-bold mb-1">Volume 2 (L)</label><input type="number" id="vol2" step="0.1" placeholder="5" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="sg2" class="block text-sm font-bold mb-1">SG 2</label><input type="number" id="sg2" step="0.001" placeholder="0.998" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <button id="calcBlendBtn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Calculate Blend</button>
                                <div id="blendResult" class="text-center font-bold text-lg mt-2 h-8"></div>
                            </div>
                        </div>

                        <div class="p-4 card rounded-lg md:col-span-2 lg:col-span-3">
                            <h3 class="text-xl font-header mb-4">AI Yeast Starter Calculator</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div><label for="starterOG" class="block text-sm font-bold mb-1">Starting Gravity of Mead</label><input type="number" id="starterOG" step="0.001" placeholder="1.110" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="yeastDate" class="block text-sm font-bold mb-1">Yeast Production Date</label><input type="date" id="yeastDate" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                                <div><label for="yeastType" class="block text-sm font-bold mb-1">Yeast Type</label><select id="yeastType" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"><option>Liquid</option><option>Dry</option></select></div>
                            </div>
                            <button id="getYeastAdviceBtn" class="w-full mt-4 bg-purple-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-800 btn">Get AI Starter Advice</button>
                            <div id="yeast-advice-output" class="prose max-w-none text-app-primary mt-4"></div>
                        </div>

                    </div>
                </div>
            </div>
            <div id="labels-view" class="hidden mt-4">
                <div class="flex flex-col lg:flex-row gap-8">
                    <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-header font-bold mb-6 border-b pb-4 border-app">Label Designer</h2>
                        <div class="space-y-4">
                            <div>
                                <label for="labelRecipeSelect" class="block text-sm font-bold mb-1">Select Recipe</label>
                                <select id="labelRecipeSelect" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                    <option value="">-- Choose a Saved Recipe --</option>
                                </select>
                            </div>
                            <div>
                                <label for="labelStyle" class="block text-sm font-bold mb-1">Style / Subtitle</label>
                                <input type="text" id="labelStyle" placeholder="e.g., Lavender & Lemon Melomel" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="labelAbv" class="block text-sm font-bold mb-1">ABV (%)</label>
                                    <input type="text" id="labelAbv" placeholder="12.5" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div>
                                <div>
                                    <label for="labelVol" class="block text-sm font-bold mb-1">Volume (ml)</label>
                                    <input type="text" id="labelVol" placeholder="750" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                </div>
                            </div>
                            <div>
                                <label for="labelDate" class="block text-sm font-bold mb-1">Bottling Date</label>
                                <input type="text" id="labelDate" placeholder="August 2025" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                            </div>
                            <div>
                                <label for="logoUpload" class="block text-sm font-bold mb-1">Upload Your Logo</label>
                                <input type="file" id="logoUpload" accept="image/*" class="w-full text-sm text-app-secondary file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-app-primary file:text-app-brand hover:file:bg-app-tertiary">
                                <button id="removeLogoBtn" class="hidden text-xs text-red-500 hover:underline mt-2">Remove logo</button>
                            </div>
                            <div class="pt-4 border-t border-app space-y-4">
                                <div>
                                    <label for="labelFormatSelect" class="block text-sm font-bold mb-2">Label Format</label>
                                    <select id="labelFormatSelect" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                        <option value="herma_4453">Herma 4453 (99.1 x 139 mm) - 4/pagina</option>
                                        <option value="avery_l7165">Avery L7165 (99.1 x 67.7 mm) - 8/pagina</option>
                                        <option value="herma_10730">Herma 10730 (99.1 x 33.8 mm) - 16/pagina</option>
                                        <option value="custom">Custom Format...</option>
                                    </select>
                                </div>
                                <div id="custom-format-inputs" class="hidden space-y-2 p-3 border rounded-md border-app">
                                     <h4 class="text-sm font-bold text-center">Custom Page Layout</h4>
                                     <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div><label>Label Width (mm)</label><input type="number" id="customWidth" value="99.1" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                        <div><label>Label Height (mm)</label><input type="number" id="customHeight" value="67.7" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                        <div><label>Columns</label><input type="number" id="customCols" value="2" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                        <div><label>Rows</label><input type="number" id="customRows" value="4" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                        <div><label>Top Margin (mm)</label><input type="number" id="customMarginTop" value="11.1" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                        <div><label>Left Margin (mm)</label><input type="number" id="customMarginLeft" value="5.45" class="w-full p-1 border rounded-md bg-app-primary"></div>
                                     </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold mb-2">Choose a Style</label>
                                    <div class="grid grid-cols-3 gap-2">
                                        <button class="label-style-btn p-2 border-2 border-app-brand rounded-lg text-app-brand btn" data-style="minimalist">Minimalist</button>
                                        <button class="label-style-btn p-2 border rounded-lg btn" data-style="industrial">Industrial</button>
                                        <button class="label-style-btn p-2 border rounded-lg btn" data-style="professional">Professional</button>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold mb-2">Orientation</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button class="orientation-btn active p-2 border-2 border-app-brand rounded-lg text-app-brand btn" data-orientation="vertical">Vertical</button>
                                        <button class="orientation-btn p-2 border rounded-lg btn" data-orientation="horizontal">Horizontal</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </aside>
                    <main class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-header font-bold mb-2 text-center">Live Preview</h2>
                        <p class="text-center text-sm text-app-secondary mb-6">Dit is hoe één etiket eruit zal zien.</p>
                        <div class="max-w-xs mx-auto">
                            <div id="label-preview" class="label-minimalist aspect-[3/4] p-4 flex flex-col">
                                <img id="label-logo-preview" src="" class="hidden h-1/3 w-auto mb-4 mx-auto"/>
                                
                                <div class="flex-grow flex flex-col justify-center text-center">
                                    <h3 id="label-name-preview" class="text-2xl font-bold font-header">Mead Name</h3>
                                    <p id="label-style-preview" class="text-sm">Style / Subtitle</p>
                                </div>
                                
                                <div class="mt-auto">
                                    <div id="label-details-container" class="w-full border-t pt-2 text-xs">
                                        <div class="detail-row flex justify-between">
                                            <span id="label-date-preview">Bottling Date</span>
                                            <span><span id="label-abv-preview">ABV</span>% ABV</span>
                                            <span><span id="label-vol-preview">VOL</span></span>
                                        </div>
                                        <div class="detail-row professional-only hidden">
                                            <span id="label-og-container">OG: <span id="label-og-preview">OG</span></span>
                                            <span id="label-fg-container">FG: <span id="label-fg-preview">FG</span></span>
                                            <span id="label-yeast-container">Yeast: <span id="label-yeast-preview">Yeast</span></span>
                                        </div>
                                    </div>
                                    <div id="label-allergens-container" class="w-full text-xs mt-1 text-center hidden">
                                         </div>
                                </div>
                            </div>
                        <div class="text-center mt-8">
                            <button id="generate-print-btn" class="w-full max-w-xs bg-app-action text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 btn">
                                Generate Printable Page
                            </button>
                        </div>
                    </main>
                </div>
            </div>
            <div id="water-view" class="hidden mt-4">
                <div class="flex flex-col lg:flex-row gap-8 lg:items-start">
                            <aside class="lg:w-1/3 bg-app-secondary p-6 rounded-lg shadow-lg flex flex-col lg:overflow-y-auto lg:max-h-[80vh]">
                       <h2 class="text-2xl font-header font-bold mb-4 border-b pb-4 border-app">Water Management</h2>    
                       <div class="mb-4">
                           <label for="waterSource" class="block text-sm font-bold mb-2">Select Water Profile</label>
                           <select id="waterSource" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></select>
                      </div>
                      <div id="waterProfileDisplay" class="mb-4 p-4 card rounded-lg">
                          <h4 class="font-bold font-header text-lg mb-2">Active Mineral Profile (mg/L)</h4>
                          <ul class="space-y-1 text-sm text-app-primary">
                              <li><strong>Ca:</strong> <span id="val-ca">--</span></li>
                              <li><strong>Mg:</strong> <span id="val-mg">--</span></li>
                              <li><strong>Na:</strong> <span id="val-na">--</span></li>
                              <li><strong>SO4:</strong> <span id="val-so4">--</span></li>
                              <li><strong>Cl:</strong> <span id="val-cl">--</span></li>
                              <li><strong>HCO3:</strong> <span id="val-hco3">--</span></li>
                          </ul>
                      </div>           
                      <hr class="border-app my-4">
                      <div id="ai-water-search-section" class="mb-4">
                          <h3 class="text-xl font-header font-bold mb-4">Find Profile with AI</h3>
                          <div class="flex gap-2">
                              <input type="text" id="ai-water-search-name" placeholder="e.g., Orval, Mont Roucous" class="flex-grow p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                              <button id="ai-water-search-btn" class="bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700 btn">Find</button>
                          </div>
                      </div>            
                      <form id="water-profile-form" class="space-y-2 pt-4 border-t border-app">
                          <input type="hidden" id="water-profile-id">
                          <h4 class="font-bold text-center">Add or Edit a Profile</h4>
                          <div>
                              <label for="water-profile-name">Profile Name</label>
                              <input type="text" id="water-profile-name" required placeholder="e.g., My Tap Water" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary">
                          </div>
                          <div class="grid grid-cols-3 gap-2">
                              <div><label for="manual_ca">Ca</label><input type="number" id="manual_ca" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                              <div><label for="manual_mg">Mg</label><input type="number" id="manual_mg" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                              <div><label for="manual_na">Na</label><input type="number" id="manual_na" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                              <div><label for="manual_so4">SO4</label><input type="number" id="manual_so4" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                              <div><label for="manual_cl">Cl</label><input type="number" id="manual_cl" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                              <div><label for="manual_hco3">HCO3</label><input type="number" id="manual_hco3" class="w-full p-1 border rounded-md bg-app-tertiary border-app text-app-primary"></div>
                          </div>
                          <button type="submit" class="w-full mt-4 bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Save Custom Profile</button>
                      </form>           
                      <div class="mt-auto pt-4 flex-grow">
                          <h3 class="text-xl font-header font-bold mt-4 mb-2">My Saved Profiles</h3>
                          <div id="user-water-profiles-list" class="space-y-2"></div>
                      </div>
                  </aside>        
                  <main class="lg:w-2/3 bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg lg:overflow-y-auto lg:max-h-[80vh]">
                      <h2 class="text-3xl font-header font-bold mb-4 text-center">AI Adjustment Recommendations</h2>
                      <div class="space-y-4 mb-6">
                          <div>
                              <label for="meadTargetProfile" class="block text-sm font-bold mb-2">Desired Mead Character</label>
                              <select id="meadTargetProfile" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                  <option value="balanced">Balanced / All-Purpose</option>
                                  <option value="dry_crisp">Dry & Crisp (e.g., Traditional, Saison)</option>
                                  <option value="rich_full">Rich & Full-bodied (e.g., Sweet Melomel, Quad)</option>
                                  <option value="hoppy_braggot">Hoppy Braggot (IPA style)</option>
                              </select>
                          </div>
                          <button id="getWaterAdviceBtn" class="w-full bg-purple-700 text-white font-bold py-3 px-4 rounded-lg hover:bg-purple-800 btn">Get Brewing Advice</button>
                      </div>
                      <div id="water-advice-output" class="prose max-w-none text-app-primary">
                          <p class="text-center text-app-secondary/80">Select a water source and a desired mead character, then ask your buddy for advice.</p>
                      </div>
                  </main>
               </div>
            </div>
            <div id="troubleshoot-view" class="hidden mt-4">
                 <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
                    <h2 class="text-3xl font-header font-bold mb-6 text-center">AI Troubleshooter</h2>
                    <div class="max-w-xl mx-auto">
                        <div class="card p-6 rounded-lg">
                            <label for="troubleshoot-description" class="block text-lg font-bold mb-2">Describe your brewing problem:</label>
                            <textarea id="troubleshoot-description" rows="5" placeholder="e.g., My fermentation seems to have stopped after only 3 days. The airlock isn't bubbling anymore." class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></textarea>
                            <button id="troubleshoot-btn" class="w-full mt-4 bg-purple-700 text-white font-bold py-3 px-4 rounded-lg hover:bg-purple-800 btn">Get Advice</button>
                        </div>
                        <div id="troubleshoot-output" class="mt-6 prose max-w-none text-app-primary"></div>
                    </div>
                 </div>
            </div>
<div id="social-view" class="hidden mt-4">
    <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg overflow-y-auto" style="max-height: 70vh;">
        <h2 class="text-3xl font-header font-bold mb-6 text-center">Social Media Assistant</h2>
        
        <!-- Recept Selecteren -->
        <div class="card p-4 rounded-lg mb-6">
            <label for="social-recipe-select" class="block text-sm font-bold mb-2">Select a Recipe from your History</label>
            <select id="social-recipe-select" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                <option value="">-- Choose a Recipe --</option>
                <!-- Recepten worden hier geladen door JS -->
            </select>
        </div>
        <div class="card p-4 rounded-lg mb-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="social-persona" class="block text-sm font-bold mb-2">AI Persona</label>
                    <select id="social-persona" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                        <option value="homebrewer">Enthusiastic Homebrewer</option>
                        <option value="pro_brewery">Professional Brewery</option>
                        <option value="sommelier">Mead Sommelier</option>
                    </select>
                </div>
                <div>
                    <label for="social-platform" class="block text-sm font-bold mb-2">Platform</label>
                    <select id="social-platform" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                        <option value="instagram">Instagram Post</option>
                        <option value="untappd_checkin">Untappd Check-in</option>
                        <option value="untappd_description">Untappd Mead Description</option>
                    </select>
                </div>
            </div>
            <div class="mt-4">
                 <label for="social-tweak" class="block text-sm font-bold mb-2">Tweak / Extra Instruction</label>
                 <textarea id="social-tweak" rows="2" placeholder="e.g., 'Make it funny', 'Focus on the honey used', etc." class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></textarea>
            </div>
        </div>
        <div id="social-from-recipe-container">
            <button id="generate-social-from-recipe-btn" class="w-full bg-app-action text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 btn">Generate Post from Selected Recipe</button>
        </div>
        <hr class="my-8 border-app">
        <div id="social-from-manual-container">
             <label for="manual-social-input" class="block text-sm font-bold mb-2">Or, generate from your own text:</label>
             <textarea id="manual-social-input" rows="4" placeholder="Type your topic here. e.g., 'Just bottled my cherry mead. It's beautifully clear with a deep red color and smells amazing!'" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary"></textarea>
             <button id="generate-manual-social-btn" class="w-full mt-4 bg-purple-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-800 btn">Generate Post from Manual Input</button>
        </div>
        <div id="social-output-container" class="mt-8 border-t border-app pt-6 hidden">
            <h3 class="text-2xl font-header font-bold mb-4">Generated Content</h3>
            <div id="social-content-container" class="mb-6"></div>
            <h3 class="text-2xl font-header font-bold mb-4">Generated Image</h3>
            <div id="social-image-container" class="p-4 card rounded-lg text-center"></div>
        </div>
    </div>
</div>
</div>
          <div id="settings-main-view" class="hidden">
            <button class="back-to-dashboard-btn mb-4 text-app-brand hover:underline no-print">&larr; Back to Dashboard</button>
            <div class="bg-app-secondary p-6 md:p-8 rounded-lg shadow-lg settings-panel overflow-y-auto" style="max-height: 80vh;">
                <h2 class="text-3xl font-header font-bold mb-6 text-center">Settings</h2>
                <div class="max-w-xl mx-auto">
                    <div class="mb-6 card p-6 rounded-lg">
    <h3 class="text-xl font-header font-bold mb-4">API Keys</h3>    
    <div class="mb-4">
        <label for="apiKeyInput" class="block text-lg font-bold mb-2">Google AI API Key (for Text)</label>
        <input type="password" id="apiKeyInput" placeholder="Enter your Google AI API key" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
        <p class="text-sm text-app-secondary mt-2">
            Required for recipe creation, analysis, etc. Get one from <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 hover:underline">Google AI Studio</a>.
        </p>
    </div>
    <div class="pt-4 border-t border-app">
        <label for="imageApiKeyInput" class="block text-lg font-bold mb-2">Image Generation API Key (for Images)</label>
        <input type="password" id="imageApiKeyInput" placeholder="Enter your Stability AI API key" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
        <p class="text-sm text-app-secondary mt-2">
            Optional, for generating images on the Social tab. Get free credits from <a href="https://platform.stability.ai/" target="_blank" class="text-blue-600 hover:underline">Stability AI</a>.
        </p>
    </div>
</div>
                    <div class="mb-6 card p-6 rounded-lg">
                        <h3 class="text-xl font-header font-bold mb-4">Personalization & Defaults</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="defaultBatchSizeInput" class="block text-lg font-bold mb-2">Default Batch Size (Liters)</label>
                                <input type="number" id="defaultBatchSizeInput" placeholder="e.g., 20" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                <p class="text-sm text-app-secondary mt-2">Set the default batch size that appears on the Creator tab.</p>
                            </div>
                            <div>
                                <label for="defaultCurrencyInput" class="block text-lg font-bold mb-2">Currency Symbol</label>
                                <input type="text" id="defaultCurrencyInput" placeholder="e.g., $" class="w-full p-2 border rounded-md bg-app-tertiary border-app text-app-primary">
                                 <p class="text-sm text-app-secondary mt-2">Set the currency symbol used for cost calculations.</p>
                            </div>
                        </div>
                    </div>
                    <div class="mb-6 card p-6 rounded-lg">
                        <h3 class="text-xl font-header font-bold mb-4">User Interface</h3>
                        <div class="flex items-center justify-between">
                            <label class="text-lg font-bold">Theme</label>
                            <div class="theme-switch-wrapper">
                                <label class="theme-switch" for="theme-toggle-checkbox">
                                    <input type="checkbox" id="theme-toggle-checkbox" />
                                    <div class="slider round"></div>
                                </label>
                            </div>
                        </div>
                    </div>             
                    <button id="saveSettingsBtn" class="w-full mt-4 bg-blue-700 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-800 btn">Save Settings</button>
                    <div class="mt-10 p-6 rounded-lg border-2 border-red-400">
                        <h3 class="text-xl font-header font-bold mb-4 text-red-600">Data Management</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <button id="exportHistoryBtn" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 btn">Export Brew History</button>
                            <button id="exportInventoryBtn" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 btn">Export Inventory</button>
                            <div>
                                <label for="importHistoryFile" class="w-full text-center block bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 cursor-pointer btn">Import Brew History</label>
                                <input type="file" id="importHistoryFile" class="hidden" accept=".json">
                            </div>
                             <div>
                                <label for="importInventoryFile" class="w-full text-center block bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 cursor-pointer btn">Import Inventory</label>
                                <input type="file" id="importInventoryFile" class="hidden" accept=".json">
                            </div>
                        </div>
                        <div class="space-y-4 mt-8 border-t-2 border-red-400 pt-4">
                            <p class="text-sm text-red-500 text-center">Warning: The following actions cannot be undone.</p>
                            <button id="clearHistoryBtn" class="w-full bg-red-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-800 btn">Delete All Brew History</button>
                            <button id="clearInventoryBtn" class="w-full bg-red-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-800 btn">Delete All Inventory</button>
                        </div>
                    </div>
                    <p class="text-center text-sm text-app-secondary/60 mt-8">MEA(N)DERY - v1.9.8.4 - © 2025</p>
                </div>
            </div>
        </div>
    </div>

<script type="module" src="app.js" defer></script>
    
</body>

</html>